---
title: "plot"
author: "Philip Kastura-Sahl"
output: pdf_document
vignette: >
  %\VignetteIndexEntry{plot}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, plot() setup, include = FALSE}
library(zeitreihen)

set.seed(742)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE,
  fig.height = 6,
  fig.width = 6,
  tidy = TRUE
)

DAX_similar <- c(
  16020.68, 16153.28, 16274.46, 16052.56, 15948.22, 15768.82, 15942.48,
  16010.25, 16033.12, 15884.32, 15933.98, 15774.08, 15809.58, 15913.59,
  15604.34, 15010.69, 15125.77, 15461.93, 15524.45, 15321.43, 15469.93,
  15621.00, 15613.90, 15370.99, 15102.76, 15209.87, 15245.61, 15485.30,
  15490.50, 15424.93, 15116.32, 15412.79, 15399.48, 15270.56, 15045.66,
  14731.93, 14696.65, 14630.81, 14051.78, 14569.44, 14461.28, 13907.42,
  14002.98, 13697.44, 13100.72, 12839.33, 12835.30, 13855.15, 13440.29,
  13631.41, 13932.70, 13916.10, 14442.32, 14389.94, 14414.88, 14327.91,
  14474.21, 14283.98, 14279.13, 14307.24, 14420.32, 14822.48, 14608.73,
  14415.22, 14447.22, 14520.75, 14427.81, 14153.52, 14079.33, 14283.99,
  14194.83, 14126.51, 14078.42, 14162.79, 14153.87, 14360.57, 14503.84,
  14149.32, 13923.11, 13754.77, 13797.94, 13982.50, 14100.10, 13938.08,
  14040.49, 13971.98, 13900.47, 13672.67, 13386.89, 13530.92, 13828.58,
  13741.04, 14029.80, 13962.56, 14188.43, 14010.79, 13886.83, 13982.92,
  14177.54, 13918.60, 14010.83, 14229.18, 14462.04, 14576.62, 14390.00,
  14343.26, 14487.11, 14461.10, 14654.47, 14560.70, 14447.13, 14196.90,
  13764.86, 13430.40, 13314.67, 13483.41, 13038.14, 13125.44, 13261.35,
  13285.83, 13142.77, 12914.21, 13117.74, 13185.41, 13241.93, 13000.63,
  12793.36, 12824.00, 12791.28, 12407.27, 12603.55, 12843.33, 13014.40,
  12835.49, 12907.73, 12747.00, 12516.67, 12861.98, 12962.63, 13315.48,
  13282.88, 13250.79, 13257.23, 13218.48, 13101.20, 13162.58, 13282.91,
  13481.70, 13480.81, 13453.01, 13581.41, 13662.52, 13577.58, 13686.28,
  13530.96, 13702.69, 13696.66, 13798.96, 13816.28, 13912.91, 13626.98,
  13697.24, 13549.38, 13241.68, 13187.04, 13220.43, 13262.62, 12970.04,
  12895.15, 12963.20, 12839.39, 12638.49, 13040.49, 12747.89, 12871.03,
  12914.88, 12907.50, 13099.20, 13408.77, 13185.99, 13016.96, 12952.66,
  12722.50, 12818.65, 12671.82, 12769.60, 12519.06, 12275.54, 12244.06,
  12109.59, 12205.93, 11982.46, 12104.53, 12240.38, 12671.75, 12516.17,
  12465.47, 12272.33, 12272.32, 12242.53, 12174.52, 12344.92, 12439.62,
  12646.35, 12769.29, 12722.53, 12769.65, 12720.25, 12930.19, 13056.95,
  13187.36, 13218.66, 13245.09, 13257.25, 13343.99, 13257.85, 13132.05,
  13458.17, 13530.67, 13686.49, 13664.29, 14150.12, 14225.33, 14312.34,
  14382.20, 14230.81, 14266.80, 14431.86, 14382.49, 14421.31, 14429.86,
  14540.78, 14543.91, 14384.86, 14358.15, 14395.88, 14493.24, 14530.87,
  14447.78, 14347.39, 14261.63, 14266.01, 14373.36, 14307.42, 14499.70,
  14461.12, 13984.36, 13892.81, 13945.25, 13887.30, 14100.09, 13914.50,
  13938.87, 13999.57, 13928.43, 14072.76, 13922.93, 14070.43, 14179.92,
  14494.45, 14437.07, 14610.80, 14791.56, 14774.20, 14949.69, 15057.87,
  15087.19, 15134.93, 15188.08, 15185.59, 14920.65, 15034.70, 15104.12,
  15092.70, 15082.71, 15133.70, 15153.21, 15129.67, 15131.10, 15185.38,
  15511.10, 15473.76, 15346.79, 15322.03, 15412.65, 15524.28, 15310.60,
  15399.95, 15382.00, 15509.36, 15533.50, 15485.30, 15478.15, 15400.01,
  15400.46, 15473.61, 15212.19, 15383.60, 15366.65, 15307.24, 15327.36,
  15578.10, 15656.35, 15560.98, 15634.47, 15634.90, 15432.26, 14961.85,
  15234.93, 14734.87, 14968.10, 14770.05, 14936.48, 15195.51, 15218.30,
  15212.56, 14959.82, 15130.98, 15139.15, 15332.51, 15524.08, 15629.77,
  15581.58, 15603.91, 15520.80, 15598.26, 15656.92, 15708.15, 15736.09,
  15809.14, 15792.65, 15884.21, 15896.59, 15797.48, 15882.67, 15864.14,
  15872.22, 15797.44, 15800.77, 15922.91, 15726.96, 15819.59, 15738.22,
  15962.98, 15955.00, 15956.90, 15897.13, 15835.63, 15915.03, 15919.38,
  15897.47, 15953.58, 16166.14, 16276.72, 16225.01, 16153.33, 15845.93,
  15797.05, 15985.59, 15954.98, 15910.66, 15665.73, 15855.35, 16052.40,
  15965.31, 15993.73, 15962.89, 15992.18, 15951.73, 16099.99, 16232.01,
  16310.70, 16291.17, 16359.35, 16203.18, 16112.84, 16025.28, 15988.92,
  15830.02, 15815.02, 15848.22, 15949.69, 15948.02, 16151.69, 16082.57,
  16043.41, 15938.10, 15532.48, 15603.90, 15673.83, 15793.07, 16024.04,
  16141.04, 16106.38, 16070.54, 16126.09, 16107.95, 16206.51, 16178.95,
  16190.57, 16214.56, 16132.80, 16406.52, 16468.77, 16448.77, 16241.51,
  16020.53, 15895.88, 15953.69, 15952.32, 15776.78, 15853.87, 15998.54,
  15830.47, 15905.85, 15768.62, 15792.63, 15678.97, 15576.55, 15603.88,
  15708.74, 15733.95, 15623.03, 15634.46, 15794.52, 15931.71, 15893.86,
  15948.09, 15845.36, 15826.44, 15772.31, 15742.50, 15716.09, 15741.86,
  15800.88, 15715.01, 15656.44, 15808.69, 15895.91, 15726.99, 15665.82,
  15783.09, 15573.21, 15560.53, 15406.74, 15256.28, 15218.72, 15322.56,
  15389.02, 15248.02, 15086.42, 15102.83, 15071.62, 15232.57, 15131.07,
  15422.91, 15462.05, 15424.91, 15187.93, 15237.84, 15254.08, 15098.60,
  15046.90, 14800.93, 14801.38, 14882.68, 14895.21, 14731.92, 14688.73,
  14715.40, 14815.32, 14924.46, 15148.46, 15190.78, 15136.07, 15153.73,
  15232.53, 15353.97, 15237.05, 15345.84, 15614.03, 15748.59, 15786.98,
  15920.18, 15902.87, 15902.30, 15957.93, 15995.28, 16027.72, 15966.85,
  15993.77, 16166.76, 16216.92, 16398.26, 16405.80, 16532.96, 16657.06,
  16629.06, 16759.36, 16793.44, 16792.90, 16769.71, 16756.83, 16756.43,
  16654.94, 16744.98, 16734.67, 16688.36, 16707.65, 16744.51, 16705.92,
  16756.47, 16770.37, 16541.30, 16616.73, 16593.95, 16716.73, 16689.72,
  16690.01, 16547.61, 16706.52, 16624.78, 16574.28, 16434.41, 16568.24,
  16557.13, 16685.00, 16628.68, 16892.00, 16909.83, 16960.88, 16939.93,
  16975.27, 16908.78, 16856.06, 16914.45, 16908.85, 17031.98, 16926.11,
  16964.99, 16933.35, 17032.80, 16881.93, 16946.04, 17037.09, 17122.13,
  17092.86, 17073.85, 17122.26, 17375.46, 17421.60, 17422.38, 17549.78,
  17599.91, 17674.58, 17737.62, 17712.71, 17709.16, 17712.82, 17840.93,
  17814.88, 17755.32, 17971.90, 17961.54, 17949.29, 17938.61, 17937.81,
  17993.98, 18019.14, 18162.67, 18168.00, 18295.57, 18389.57, 18484.03,
  18505.71, 18299.94, 18366.16, 18406.75, 18161.82, 18314.02, 18078.58,
  18095.82, 17951.78, 17927.73, 18027.35, 17764.70, 17768.50, 17839.84,
  17738.07, 17861.16, 18137.71, 18091.88, 17920.75, 18150.70, 18120.75,
  17937.71, 17897.85, 17999.63, 18161.86, 18418.85, 18506.88, 18691.36,
  18763.26, 18740.33, 18719.53, 18877.07, 18739.64, 18707.14, 18762.49,
  18733.82, 18687.84, 18692.30, 18694.95, 18763.64, 18687.37, 18483.27,
  18506.56, 18506.79, 18635.60, 18407.25, 18557.98, 18680.09, 18518.66,
  18506.19, 18366.61, 18675.73, 18296.45, 18002.80, 18067.26, 18134.02,
  18067.20, 18265.02, 18159.52, 18328.70, 18162.34, 18149.54, 18198.05,
  18261.28, 18303.75, 18159.63, 18387.60, 18441.53, 18483.70, 18483.03,
  18261.42, 18407.57, 18514.12, 18751.50, 18560.97, 18510.81, 18420.30,
  18363.57, 18161.20, 18407.54, 18518.75, 18390.19, 18305.36, 18409.64,
  18314.36, 18408.36, 18508.94
)
```

## the spectral density plotting function `plot()`
The periodogram of \(\{x_1, \dots, x_n\}\) is the function \(I_n(\lambda) = \frac{1}{n} \left| \sum_{t=1}^{n} x_t e^{-it \lambda} \right|^2\)
\
The `plot(X, n)`-function provides a spectral density plot of a time series. The function takes a time series as input and returns a plot of the spectral density.
```{r, plot() basic usage}
set.seed(742)
num_samples <- 10
X <- stats::rnorm(30)
zeitreihen::plot(X, num_samples)
```

### Adjusting the samples
By default, the plot takes `n`-samples from the interval of \((0, \pi]\) and evaluates the spectral density across it using the `periodogram()` function. To get a more detailed.
```{r, plot() adjust sample size}
num_samples <- 250
X <- stats::rnorm(30)
zeitreihen::plot(X, num_samples)
```

### Adjusting the interval
The `plot()` function also allows you to adjust the interval over which the spectral density is calculated by modifying the `from` and `to` parameters. By default, the interval is \((0, \pi]\), but you can specify a different interval that best suits your analysis. \
\
For example, to evaluate the spectral density over the interval \((\pi/2, \pi]\):
```{r, plot() adjusting interval}
num_samples <- 250
X <- stats::rnorm(30)
zeitreihen::plot(X, num_samples, from = pi / 2, to = pi)
```
By adjusting the `from` and `to` parameters, you can hone in on specific regions of interest in the frequency spectrum, allowing for more detailed spectral density analysis.

### Practical Example
Here we will be using `DAX_similar`, a dataset approximating the course of the DAX between 2022-01-03 and 2024-07-31.
```{r, plot() practical example}
summary(DAX_similar)
num_samples <- 250
zeitreihen::plot(DAX_similar, num_samples, from = pi / 2, to = pi)
```

### Requirements
`X` should be a native vector consisting of either numeric (real numbers) or complex numbers. `X` should not include any values that are not finite such as `Inf`, `NaN` or `NA`.
```{r, plot() Example error with X, error = TRUE}
num_samples <- 10
X <- c(0, 1, 3, 4, Inf, NA)
zeitreihen::plot(X, num_samples)
```

`n` should be a whole number without any decimal component and should be a single value, not a vector.
```{r, plot() Example error with n, error = TRUE}
num_samples <- 10.42
X <- stats::rnorm(30)
zeitreihen::plot(X, num_samples)
```

### References
If you need more information, please refer to the package documentation or the following resources:

- [Introduction to Time Series and Forecasting](https://link.springer.com/book/10.1007/978-3-319-29854-2)
