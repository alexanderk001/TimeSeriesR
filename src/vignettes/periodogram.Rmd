---
title: "periodogram"
author: "Alexander Klaus"
output: pdf_document
vignette: >
  %\VignetteIndexEntry{periodogram}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, periodogram() setup, include = FALSE}
library(zeitreihen)

set.seed(742)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE,
  fig.height = 6,
  fig.width = 6,
  tidy = TRUE
)
```

## The spectral density periodogram `periodogram()`
The spectral density of a stationary process shows how the variance of the time series is distributed over different frequencies. As a fundamental tool of time series analysis, the `periodogram` function is used to estimate the spectral density of a stationary time series.

### Basic Usage
Use rnorm to generate a random time series, then calculate the periodogram for the specified time series at \(\lambda = \frac{\pi}{4}\). Note: lambda has to be within \((-\pi, \pi]\)
```{r, periodogram() basic usage}
X <- stats::rnorm(100)
lambda <- pi / 4
periodogram(X, lambda)
```

What is happening inside the function:

- *Input Validation*: The function checks whether the time series \(X\) has been passed in the correct format and lambda is a numerical value from the interval \((-\pi, \pi]\) .
- Each value \(X_t\) of the time series \(X\) is multiplied by \(e^{-it\lambda}\) , where \(t\) is the time index.
- The sum of these products is computed.
- The absolute value of this sum is calculated and raised to the power of 2.
- The result is divided by the length of the time series \(n\) and returned as the periodogram value.

### Periodogram for a Simple Sine Curve
Create a simple sine curve sample:
```{r, periodogram() sin}
X <- sin(2 * pi * 1:100 / 100)
lambda <- 2 * pi / 100
periodogram(X, lambda)
```

### Periodogram for a Complex Exponential Curve
Generate a complex exponential curve sample:
```{r, periodogram() complex exponential}
X <- exp(2 * pi * 1i * 1:100 / 100)
lambda <- 2 * pi / 100
periodogram(X, lambda)
```

### Requirements
If the input does not correspond to the correct format, appropriate error messages are printed to inform the user what is wrong with their input. Here are several examples of how incorrect inputs are handled. \
The time series data must be passed in an atomic vector:
```{r, periodogram() time series error (format), error = TRUE}
X <- list(1, 2, 3, 4, 5)
lambda <- pi / 2

periodogram(X, lambda)
```

The values of this atomic vector must be numeric or complex:
```{r, periodogram() time series error (value format), error = TRUE}
X <- c(1, 2, "3", 4, "5i")
lambda <- pi / 2

periodogram(X, lambda)
```

Similarly, the atomic vector may not contain any NAs:
```{r, periodogram() time series error (value), error = TRUE}
X <- c(1, NA, 2, 3, NA, 5)
lambda <- pi / 2
periodogram(X, lambda)
```

The lambda parameter must be a numerical value:
```{r, periodogram() lambda error (format), error = TRUE}
X <- 1:10
lambda <- "0"

periodogram(X, lambda)
```

Also, lambda must lie within the interval \((-\pi, \pi]\):
```{r, periodogram() lambda error (range), error = TRUE}
X <- 1:10
lambda <- 2 * pi

periodogram(X, lambda)
```
